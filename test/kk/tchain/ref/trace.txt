100: DIM Q(20, 20), N(20, 20), R(20, 20)
110: DIM T(20), U(20)
130: READ M, N
 M = 2
 N = 4
140: MAT READ Q(N, N)
 N: 4
 Q(1,1) = 0
 Q(1,2) = 0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = 0.3333
 Q(2,2) = 0
 Q(2,3) = 0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = 0.3333
 Q(3,3) = 0
 Q(3,4) = 0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = 0.3333
 Q(4,4) = 0
150: MAT READ R(N, M)
 N: 4
 M: 2
 R(1,1) = 0.3333
 R(1,2) = 0
 R(2,1) = 0
 R(2,2) = 0
 R(3,1) = 0
 R(3,2) = 0
 R(4,1) = 0
 R(4,2) = 0.6667
160: MAT N = IDN(N, N)
 N: 4
 N(1,1) = 1
 N(1,2) = 0
 N(1,3) = 0
 N(1,4) = 0
 N(2,1) = 0
 N(2,2) = 1
 N(2,3) = 0
 N(2,4) = 0
 N(3,1) = 0
 N(3,2) = 0
 N(3,3) = 1
 N(3,4) = 0
 N(4,1) = 0
 N(4,2) = 0
 N(4,3) = 0
 N(4,4) = 1
170: MAT U = CON(N)
 N: 4
 U(1) = 1
 U(2) = 1
 U(3) = 1
 U(4) = 1
190: PRINT "TRANSIENT TO TRANSIENT PROBABILITIES"
TRANSIENT TO TRANSIENT PROBABILITIES
200: PRINT

210: MAT PRINT Q
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 0        0.6667   0        0
 0.3333   0        0.6667   0
 0        0.3333   0        0.6667
 0        0        0.3333   0

230: PRINT "TRANSIENT TO ABSORBING PROBABILITIES"
TRANSIENT TO ABSORBING PROBABILITIES
240: PRINT

250: MAT PRINT R
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 0.3333   0
 0        0
 0        0
 0        0.6667

270: MAT Q = N - Q
 N(1,1): 1
 N(1,2): 0
 N(1,3): 0
 N(1,4): 0
 N(2,1): 0
 N(2,2): 1
 N(2,3): 0
 N(2,4): 0
 N(3,1): 0
 N(3,2): 0
 N(3,3): 1
 N(3,4): 0
 N(4,1): 0
 N(4,2): 0
 N(4,3): 0
 N(4,4): 1
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 Q(1,1) = 1
 Q(1,2) = -0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = -0.3333
 Q(2,2) = 1
 Q(2,3) = -0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = -0.3333
 Q(3,3) = 1
 Q(3,4) = -0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = -0.3333
 Q(4,4) = 1
280: MAT N = INV(Q)
 Q(1,1): 1
 Q(1,2): -0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): -0.3333
 Q(2,2): 1
 Q(2,3): -0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): -0.3333
 Q(3,3): 1
 Q(3,4): -0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): -0.3333
 Q(4,4): 1
 N(1,1) = 1.45156
 N(1,2) = 1.35482
 N(1,3) = 1.16132
 N(1,4) = 0.774253
 N(2,1) = 0.67731
 N(2,2) = 2.03213
 N(2,3) = 1.74189
 N(2,4) = 1.16132
 N(3,1) = 0.290242
 N(3,2) = 0.870816
 N(3,3) = 2.03213
 N(3,4) = 1.35483
 N(4,1) = 0.0967378
 N(4,2) = 0.290243
 N(4,3) = 0.677311
 N(4,4) = 1.45156
290: PRINT "FUNDAMENTAL MATRIX"
FUNDAMENTAL MATRIX
300: PRINT

310: MAT PRINT N
 N(1,1): 1.45156
 N(1,2): 1.35482
 N(1,3): 1.16132
 N(1,4): 0.774253
 N(2,1): 0.67731
 N(2,2): 2.03213
 N(2,3): 1.74189
 N(2,4): 1.16132
 N(3,1): 0.290242
 N(3,2): 0.870816
 N(3,3): 2.03213
 N(3,4): 1.35483
 N(4,1): 0.0967378
 N(4,2): 0.290243
 N(4,3): 0.677311
 N(4,4): 1.45156
 1.45156  1.35482  1.16132  0.774253
 0.67731  2.03213  1.74189  1.16132
 0.290242          0.870816          2.03213  1.35483
 0.0967378         0.290243          0.677311          1.45156

330: MAT T = N * U
 N(1,1): 1.45156
 N(1,2): 1.35482
 N(1,3): 1.16132
 N(1,4): 0.774253
 N(2,1): 0.67731
 N(2,2): 2.03213
 N(2,3): 1.74189
 N(2,4): 1.16132
 N(3,1): 0.290242
 N(3,2): 0.870816
 N(3,3): 2.03213
 N(3,4): 1.35483
 N(4,1): 0.0967378
 N(4,2): 0.290243
 N(4,3): 0.677311
 N(4,4): 1.45156
 U(1): 1
 U(2): 1
 U(3): 1
 U(4): 1
 T(1) = 4.74195
 T(2) = 5.61265
 T(3) = 4.54802
 T(4) = 2.51585
340: PRINT "ABSORBTION TIMES"
ABSORBTION TIMES
350: PRINT

360: MAT PRINT T
 T(1): 4.74195
 T(2): 5.61265
 T(3): 4.54802
 T(4): 2.51585
 4.74195  5.61265  4.54802  2.51585

380: MAT Q = N * R
 N(1,1): 1.45156
 N(1,2): 1.35482
 N(1,3): 1.16132
 N(1,4): 0.774253
 N(2,1): 0.67731
 N(2,2): 2.03213
 N(2,3): 1.74189
 N(2,4): 1.16132
 N(3,1): 0.290242
 N(3,2): 0.870816
 N(3,3): 2.03213
 N(3,4): 1.35483
 N(4,1): 0.0967378
 N(4,2): 0.290243
 N(4,3): 0.677311
 N(4,4): 1.45156
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 Q(1,1) = 0.483805
 Q(1,2) = 0.516194
 Q(2,1) = 0.225747
 Q(2,2) = 0.774252
 Q(3,1) = 0.0967377
 Q(3,2) = 0.903265
 Q(4,1) = 0.0322427
 Q(4,2) = 0.967755
390: PRINT "ABSORBTION PROBABILITIES"
ABSORBTION PROBABILITIES
400: PRINT

410: MAT PRINT Q
 Q(1,1): 0.483805
 Q(1,2): 0.516194
 Q(2,1): 0.225747
 Q(2,2): 0.774252
 Q(3,1): 0.0967377
 Q(3,2): 0.903265
 Q(4,1): 0.0322427
 Q(4,2): 0.967755
 0.483805          0.516194
 0.225747          0.774252
 0.0967377         0.903265
 0.0322427         0.967755

999: END
STOP in line 999


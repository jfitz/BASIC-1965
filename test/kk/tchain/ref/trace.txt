100: DIM Q(20, 20), N(20, 20), R(20, 20)
110: DIM T(20), U(20)
120:
130: READ M, N
 M = 2
 N = 4
140: MAT READ Q(N, N)
 Q(1,1) = 0
 Q(1,2) = 0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = 0.3333
 Q(2,2) = 0
 Q(2,3) = 0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = 0.3333
 Q(3,3) = 0
 Q(3,4) = 0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = 0.3333
 Q(4,4) = 0
150: MAT READ R(N, M)
 R(1,1) = 0.3333
 R(1,2) = 0
 R(2,1) = 0
 R(2,2) = 0
 R(3,1) = 0
 R(3,2) = 0
 R(4,1) = 0
 R(4,2) = 0.6667
160: MAT N = IDN(N, N)
 N: 4
 N(1,1) = 1
 N(1,2) = 0
 N(1,3) = 0
 N(1,4) = 0
 N(2,1) = 0
 N(2,2) = 1
 N(2,3) = 0
 N(2,4) = 0
 N(3,1) = 0
 N(3,2) = 0
 N(3,3) = 1
 N(3,4) = 0
 N(4,1) = 0
 N(4,2) = 0
 N(4,3) = 0
 N(4,4) = 1
170: MAT U = CON(N)
 N: 4
 U(1) = 1
 U(2) = 1
 U(3) = 1
 U(4) = 1
180:
190: PRINT "TRANSIENT TO TRANSIENT PROBABILITIES"
TRANSIENT TO TRANSIENT PROBABILITIES
200: PRINT

210: MAT PRINT Q;
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 0     0.6667      0     0    
 0.3333      0     0.6667      0    
 0     0.3333      0     0.6667     
 0     0     0.3333      0    

220:
230: PRINT "TRANSIENT TO ABSORBING PROBABILITIES"
TRANSIENT TO ABSORBING PROBABILITIES
240: PRINT

250: MAT PRINT R;
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 0.3333      0    
 0     0    
 0     0    
 0     0.6667     

260:
270: MAT Q = N - Q
 N(1,1): 1
 N(1,2): 0
 N(1,3): 0
 N(1,4): 0
 N(2,1): 0
 N(2,2): 1
 N(2,3): 0
 N(2,4): 0
 N(3,1): 0
 N(3,2): 0
 N(3,3): 1
 N(3,4): 0
 N(4,1): 0
 N(4,2): 0
 N(4,3): 0
 N(4,4): 1
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 Q(1,1) = 1
 Q(1,2) = -0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = -0.3333
 Q(2,2) = 1
 Q(2,3) = -0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = -0.3333
 Q(3,3) = 1
 Q(3,4) = -0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = -0.3333
 Q(4,4) = 1
280: MAT N = INV(Q)
 Q(1,1): 1
 Q(1,2): -0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): -0.3333
 Q(2,2): 1
 Q(2,3): -0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): -0.3333
 Q(3,3): 1
 Q(3,4): -0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): -0.3333
 Q(4,4): 1
 N(1,1) = 1.451563265680995
 N(1,2) = 1.3548252795709417
 N(1,3) = 1.161320283052573
 N(1,4) = 0.7742522327111505
 N(2,1) = 0.6773110329698439
 N(2,2) = 2.0321363125407856
 N(2,3) = 1.7418933299123642
 N(2,4) = 1.161320283052573
 N(3,1) = 0.2902429826284211
 N(3,2) = 0.8708160294882121
 N(3,3) = 2.0321363125407856
 N(3,4) = 1.3548252795709417
 N(4,1) = 0.09673798611005274
 N(4,2) = 0.2902429826284211
 N(4,3) = 0.6773110329698439
 N(4,4) = 1.451563265680995
290: PRINT "FUNDAMENTAL MATRIX"
FUNDAMENTAL MATRIX
300: PRINT

310: MAT PRINT N;
 N(1,1): 1.451563265680995
 N(1,2): 1.3548252795709417
 N(1,3): 1.161320283052573
 N(1,4): 0.7742522327111505
 N(2,1): 0.6773110329698439
 N(2,2): 2.0321363125407856
 N(2,3): 1.7418933299123642
 N(2,4): 1.161320283052573
 N(3,1): 0.2902429826284211
 N(3,2): 0.8708160294882121
 N(3,3): 2.0321363125407856
 N(3,4): 1.3548252795709417
 N(4,1): 0.09673798611005274
 N(4,2): 0.2902429826284211
 N(4,3): 0.6773110329698439
 N(4,4): 1.451563265680995
 1.45156     1.35483     1.16132     0.77425    
 0.67731     2.03214     1.74189     1.16132    
 0.29024     0.87082     2.03214     1.35483    
 0.096738    0.29024     0.67731     1.45156    

320:
330: MAT T = N * U
 N(1,1): 1.451563265680995
 N(1,2): 1.3548252795709417
 N(1,3): 1.161320283052573
 N(1,4): 0.7742522327111505
 N(2,1): 0.6773110329698439
 N(2,2): 2.0321363125407856
 N(2,3): 1.7418933299123642
 N(2,4): 1.161320283052573
 N(3,1): 0.2902429826284211
 N(3,2): 0.8708160294882121
 N(3,3): 2.0321363125407856
 N(3,4): 1.3548252795709417
 N(4,1): 0.09673798611005274
 N(4,2): 0.2902429826284211
 N(4,3): 0.6773110329698439
 N(4,4): 1.451563265680995
 U(1): 1
 U(2): 1
 U(3): 1
 U(4): 1
 T(1) = 4.74196106101566
 T(2) = 5.612660958475567
 T(3) = 4.548020604228361
 T(4) = 2.5158552673893126
340: PRINT "ABSORBTION TIMES"
ABSORBTION TIMES
350: PRINT

360: MAT PRINT T;
 T(1): 4.74196106101566
 T(2): 5.612660958475567
 T(3): 4.548020604228361
 T(4): 2.5158552673893126
 4.74196     5.61266     4.54802     2.51586    

370:
380: MAT Q = N * R
 N(1,1): 1.451563265680995
 N(1,2): 1.3548252795709417
 N(1,3): 1.161320283052573
 N(1,4): 0.7742522327111505
 N(2,1): 0.6773110329698439
 N(2,2): 2.0321363125407856
 N(2,3): 1.7418933299123642
 N(2,4): 1.161320283052573
 N(3,1): 0.2902429826284211
 N(3,2): 0.8708160294882121
 N(3,3): 2.0321363125407856
 N(3,4): 1.3548252795709417
 N(4,1): 0.09673798611005274
 N(4,2): 0.2902429826284211
 N(4,3): 0.6773110329698439
 N(4,4): 1.451563265680995
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 Q(1,1) = 0.4838060364514756
 Q(1,2) = 0.516193963548524
 Q(2,1) = 0.22574776728884893
 Q(2,2) = 0.7742522327111504
 Q(3,1) = 0.09673798611005274
 Q(3,2) = 0.9032620138899468
 Q(4,1) = 0.03224277077048058
 Q(4,2) = 0.9677572292295192
390: PRINT "ABSORBTION PROBABILITIES"
ABSORBTION PROBABILITIES
400: PRINT

410: MAT PRINT Q;
 Q(1,1): 0.4838060364514756
 Q(1,2): 0.516193963548524
 Q(2,1): 0.22574776728884893
 Q(2,2): 0.7742522327111504
 Q(3,1): 0.09673798611005274
 Q(3,2): 0.9032620138899468
 Q(4,1): 0.03224277077048058
 Q(4,2): 0.9677572292295192
 0.48381     0.51619    
 0.22575     0.77425    
 0.096738    0.90326    
 0.032243    0.96776    

420:
430: DATA 2, 4
440: DATA 0, 0.6667, 0, 0
450: DATA 0.3333, 0, 0.6667, 0
460: DATA 0, 0.3333, 0, 0.6667
470: DATA 0, 0, 0.3333, 0
480: DATA 0.3333, 0
490: DATA 0, 0
500: DATA 0, 0
510: DATA 0, 0.6667
999: END
STOP in line 999

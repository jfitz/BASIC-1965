100: DIM Q(20, 20), N(20, 20), R(20, 20)
110: DIM T(20), U(20)
120:
130: READ M, N
 M = 2
 N = 4
140: MAT READ Q(N, N)
 N: 4
 Q(1,1) = 0
 Q(1,2) = 0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = 0.3333
 Q(2,2) = 0
 Q(2,3) = 0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = 0.3333
 Q(3,3) = 0
 Q(3,4) = 0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = 0.3333
 Q(4,4) = 0
150: MAT READ R(N, M)
 N: 4
 M: 2
 R(1,1) = 0.3333
 R(1,2) = 0
 R(2,1) = 0
 R(2,2) = 0
 R(3,1) = 0
 R(3,2) = 0
 R(4,1) = 0
 R(4,2) = 0.6667
160: MAT N = IDN(N, N)
 N: 4
 N(1,1) = 1
 N(1,2) = 0
 N(1,3) = 0
 N(1,4) = 0
 N(2,1) = 0
 N(2,2) = 1
 N(2,3) = 0
 N(2,4) = 0
 N(3,1) = 0
 N(3,2) = 0
 N(3,3) = 1
 N(3,4) = 0
 N(4,1) = 0
 N(4,2) = 0
 N(4,3) = 0
 N(4,4) = 1
170: MAT U = CON(N)
 N: 4
 U(1) = 1
 U(2) = 1
 U(3) = 1
 U(4) = 1
180:
190: PRINT "TRANSIENT TO TRANSIENT PROBABILITIES"
TRANSIENT TO TRANSIENT PROBABILITIES
200: PRINT

210: MAT PRINT Q;
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 0  0.6667  0  0 
 0.3333  0  0.6667  0 
 0  0.3333  0  0.6667 
 0  0  0.3333  0 

220:
230: PRINT "TRANSIENT TO ABSORBING PROBABILITIES"
TRANSIENT TO ABSORBING PROBABILITIES
240: PRINT

250: MAT PRINT R;
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 0.3333  0 
 0  0 
 0  0 
 0  0.6667 

260:
270: MAT Q = N - Q
 N(1,1): 1
 N(1,2): 0
 N(1,3): 0
 N(1,4): 0
 N(2,1): 0
 N(2,2): 1
 N(2,3): 0
 N(2,4): 0
 N(3,1): 0
 N(3,2): 0
 N(3,3): 1
 N(3,4): 0
 N(4,1): 0
 N(4,2): 0
 N(4,3): 0
 N(4,4): 1
 Q(1,1): 0
 Q(1,2): 0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): 0.3333
 Q(2,2): 0
 Q(2,3): 0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): 0.3333
 Q(3,3): 0
 Q(3,4): 0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): 0.3333
 Q(4,4): 0
 Q(1,1) = 1
 Q(1,2) = -0.6667
 Q(1,3) = 0
 Q(1,4) = 0
 Q(2,1) = -0.3333
 Q(2,2) = 1
 Q(2,3) = -0.6667
 Q(2,4) = 0
 Q(3,1) = 0
 Q(3,2) = -0.3333
 Q(3,3) = 1
 Q(3,4) = -0.6667
 Q(4,1) = 0
 Q(4,2) = 0
 Q(4,3) = -0.3333
 Q(4,4) = 1
280: MAT N = INV(Q)
 Q(1,1): 1
 Q(1,2): -0.6667
 Q(1,3): 0
 Q(1,4): 0
 Q(2,1): -0.3333
 Q(2,2): 1
 Q(2,3): -0.6667
 Q(2,4): 0
 Q(3,1): 0
 Q(3,2): -0.3333
 Q(3,3): 1
 Q(3,4): -0.6667
 Q(4,1): 0
 Q(4,2): 0
 Q(4,3): -0.3333
 Q(4,4): 1
 N(1,1) = 1.451563
 N(1,2) = 1.354825
 N(1,3) = 1.16132
 N(1,4) = 0.7742523
 N(2,1) = 0.677311
 N(2,2) = 2.032136
 N(2,3) = 1.741893
 N(2,4) = 1.16132
 N(3,1) = 0.2902429
 N(3,2) = 0.8708159
 N(3,3) = 2.032136
 N(3,4) = 1.354825
 N(4,1) = 0.09673797
 N(4,2) = 0.290243
 N(4,3) = 0.6773111
 N(4,4) = 1.451563
290: PRINT "FUNDAMENTAL MATRIX"
FUNDAMENTAL MATRIX
300: PRINT

310: MAT PRINT N;
 N(1,1): 1.451563
 N(1,2): 1.354825
 N(1,3): 1.16132
 N(1,4): 0.7742523
 N(2,1): 0.677311
 N(2,2): 2.032136
 N(2,3): 1.741893
 N(2,4): 1.16132
 N(3,1): 0.2902429
 N(3,2): 0.8708159
 N(3,3): 2.032136
 N(3,4): 1.354825
 N(4,1): 0.09673797
 N(4,2): 0.290243
 N(4,3): 0.6773111
 N(4,4): 1.451563
 1.45156  1.35483  1.16132  0.77425 
 0.67731  2.03214  1.74189  1.16132 
 0.29024  0.87082  2.03214  1.35483 
 0.096738  0.29024  0.67731  1.45156 

320:
330: MAT T = N * U
 N(1,1): 1.451563
 N(1,2): 1.354825
 N(1,3): 1.16132
 N(1,4): 0.7742523
 N(2,1): 0.677311
 N(2,2): 2.032136
 N(2,3): 1.741893
 N(2,4): 1.16132
 N(3,1): 0.2902429
 N(3,2): 0.8708159
 N(3,3): 2.032136
 N(3,4): 1.354825
 N(4,1): 0.09673797
 N(4,2): 0.290243
 N(4,3): 0.6773111
 N(4,4): 1.451563
 U(1): 1
 U(2): 1
 U(3): 1
 U(4): 1
 T(1) = 4.74196
 T(2) = 5.61266
 T(3) = 4.54802
 T(4) = 2.515855
340: PRINT "ABSORBTION TIMES"
ABSORBTION TIMES
350: PRINT

360: MAT PRINT T;
 T(1): 4.74196
 T(2): 5.61266
 T(3): 4.54802
 T(4): 2.515855
 4.74196  5.61266  4.54802  2.51586 

370:
380: MAT Q = N * R
 N(1,1): 1.451563
 N(1,2): 1.354825
 N(1,3): 1.16132
 N(1,4): 0.7742523
 N(2,1): 0.677311
 N(2,2): 2.032136
 N(2,3): 1.741893
 N(2,4): 1.16132
 N(3,1): 0.2902429
 N(3,2): 0.8708159
 N(3,3): 2.032136
 N(3,4): 1.354825
 N(4,1): 0.09673797
 N(4,2): 0.290243
 N(4,3): 0.6773111
 N(4,4): 1.451563
 R(1,1): 0.3333
 R(1,2): 0
 R(2,1): 0
 R(2,2): 0
 R(3,1): 0
 R(3,2): 0
 R(4,1): 0
 R(4,2): 0.6667
 Q(1,1) = 0.4838059
 Q(1,2) = 0.516194
 Q(2,1) = 0.2257478
 Q(2,2) = 0.774252
 Q(3,1) = 0.09673796
 Q(3,2) = 0.9032618
 Q(4,1) = 0.03224277
 Q(4,2) = 0.9677571
390: PRINT "ABSORBTION PROBABILITIES"
ABSORBTION PROBABILITIES
400: PRINT

410: MAT PRINT Q;
 Q(1,1): 0.4838059
 Q(1,2): 0.516194
 Q(2,1): 0.2257478
 Q(2,2): 0.774252
 Q(3,1): 0.09673796
 Q(3,2): 0.9032618
 Q(4,1): 0.03224277
 Q(4,2): 0.9677571
 0.48381  0.51619 
 0.22575  0.77425 
 0.096738  0.90326 
 0.032243  0.96776 

420:
430: DATA 2, 4
440: DATA 0, 0.6667, 0, 0
450: DATA 0.3333, 0, 0.6667, 0
460: DATA 0, 0.3333, 0, 0.6667
470: DATA 0, 0, 0.3333, 0
480: DATA 0.3333, 0
490: DATA 0, 0
500: DATA 0, 0
510: DATA 0, 0.6667
999: END
STOP in line 999


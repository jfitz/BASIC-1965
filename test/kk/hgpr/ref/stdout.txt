SEARCH FOR PRIMES OF THE FORM A*1000 + B, 0 < B < 2000.

A = ? 7890

B = 

 13  41  49  61  67  83  97  119  137  143  161  191  209  217  251  299  307  319  331  343  347  373  391  413  427  437  439  479  503  511  517  539  551  557  563  569  607  611  661  683  691  713  733  739  749  763  769  787  797  811  847  851  859  881  913  919  923  943  959  979  989  991  997  1031  1033  1067  1069  1123  1141  1151  1171  1181  1183  1187  1207  1211  1217  1237  1259  1271  1283  1297  1307  1313  1361  1379  1381  1421  1423  1439  1463  1469  1483  1493  1523  1537  1549  1589  1591  1603  1613  1649  1651  1673  1703  1717  1727  1739  1769  1777  1787  1801  1813  1847  1853  1861  1867  1901  1909  1913  1951  1969  1979  1981  1987  1991 

THERE ARE  126 PRIMES IN THE RANGE.


TWIN PRIMES:

 437             439
 989             991
 1031            1033
 1067            1069
 1181            1183
 1379            1381
 1421            1423
 1589            1591
 1649            1651
 1979            1981
STOP in line 790

10 (1) DIM N(1000)
11 (1) DIM P(350)
20 F(I) (1) FOR I = 1 TO 1000
21 F(I) (1000) LET N(I) = 0
22 F(I) (1000) NEXT I
25 (1) LET P(0) = 2
26 (1) LET K = 0
30 F(P) (1) FOR P = 3 TO 2000 STEP 2
35 F(P) (999) LET X = (P - 1) / 2
40 F(P) (999) IF N(X) < 0 THEN 90
50 F(P) (302) LET K = K + 1
55 F(P) (302) LET P(K) = P
56 F(P) (302) IF P > SQR(2000) THEN 90
60 F(P,I) (13) FOR I = P TO 2000 STEP 2 * P
65 F(P,I) (1139) LET X = (I - 1) / 2
70 F(P,I) (1139) LET N(X) = -1
80 F(P,I) (1139) NEXT I
90 F(P) (999) NEXT P
100 (0) REM READ LEADING DIGITS
110 (1) PRINT "SEARCH FOR PRIMES OF THE FORM A*1000 + B, 0 < B < 2000."
115 (1) PRINT
116 (1) PRINT "A = ";
120 (1) INPUT A
125 (1) LET S = SQR((A + 2) * 1000)
130 (1) PRINT
140 (1) PRINT "B = "
150 (1) PRINT
160 (0) 
200 (0) REM TEST PRIMES TO 2000
205 F(I) (1) FOR I = 1 TO 1000
206 F(I) (1000) LET N(I) = 0
207 F(I) (1000) NEXT I
210 F(I) (1) FOR I = 1 TO K
220 F(I) (302) LET F = P(I)
230 F(I) (302) GOSUB 800
239 F(I) (302) IF Z > 999 THEN 270
240 F(I,J) (264) FOR J = Z TO 999 STEP F
250 F(I,J) (1798) LET N(J) = -1
260 F(I,J) (1798) NEXT J
270 F(I) (302) NEXT I
280 (0) 
400 (0) REM TEST REMAINING NUMBERS
405 (1) LET D = 2
410 (1) LET F = 2003
420 (270) GOSUB 800
430 (270) IF Z > 999 THEN 450
440 (117) LET N(Z) = -1
450 (270) LET F = F + D
460 (270) LET D = 6 - D
470 (270) IF F <= S THEN 420
480 (0) 
700 (0) REM PRINT RESULT
702 (1) LET S = 0
705 F(I) (1) FOR I = 0 TO 999
710 F(I) (1000) IF N(I) < 0 THEN 730
720 F(I) (126) PRINT 2 * I + 1;
725 F(I) (126) LET S = S + 1
730 F(I) (1000) NEXT I
732 (1) PRINT
733 (1) PRINT
735 (1) PRINT "THERE ARE " S; "PRIMES IN THE RANGE."
740 (1) PRINT
745 (1) PRINT
750 (1) PRINT "TWIN PRIMES:"
752 (1) PRINT
755 F(I) (1) FOR I = 0 TO 998
760 F(I) (999) IF N(I) < 0 THEN 780
765 F(I) (126) IF N(I + 1) < 0 THEN 780
770 F(I) (10) PRINT 2 * I + 1, 2 * I + 3
780 F(I) (999) NEXT I
790 (1) STOP
795 (0) 
800 (0) REM TEST FACTOR F
810 G(810) (572) LET X = A - F * INT(A / F)
820 G(810) (572) LET Y = A * 1000
830 G(810) (572) LET X = F - (Y - F * INT(Y / F))
840 G(810) (572) IF X <> 2 * INT(X / 2) THEN 860
850 G(810) (277) LET X = X + F
860 G(810) (572) LET Z = (X - 1) / 2
870 G(810) (572) RETURN
999 (0) END


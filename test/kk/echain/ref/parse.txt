100 DIM P(20,20), M(20,20), Z(20,20), A(1,20), B(1,20)
 NumericConstant:20
 NumericConstant:20
 Declaration:P
 NumericConstant:20
 NumericConstant:20
 Declaration:M
 NumericConstant:20
 NumericConstant:20
 Declaration:Z
 NumericConstant:1
 NumericConstant:20
 Declaration:A
 NumericConstant:1
 NumericConstant:20
 Declaration:B
110
120 READ N
 ScalarReference:N
130 MAT READ P(N,N)
 ScalarValue:N
 ScalarValue:N
 MatrixReference:P
140 MAT Z = IDN(N,N)
 MatrixReference:Z
 ScalarValue:N
 ScalarValue:N
 FunctionIdn
 AssignmentOperator:=
150
160 PRINT "TRANSITION PROBABILITIES"
 ITEMS
 TextConstant:"TRANSITION PROBABILITIES"
 CarriageControl:NL
170 PRINT
 ITEMS
 CarriageControl:NL
180 MAT PRINT P;
 ITEMS
 MatrixValue:P
 CarriageControl:;
190
200 MAT Z = Z-P
 MatrixReference:Z
 MatrixValue:Z
 MatrixValue:P
 BinaryOperator:-
 AssignmentOperator:=
210 FOR I = 1 TO N
 control: VariableName:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
220 LET Z(I,N) = 1
 ScalarValue:I
 ScalarValue:N
 ScalarReference:Z
 NumericConstant:1
 AssignmentOperator:=
230 NEXT I
 VariableName:I
240 MAT M = INV(Z)
 MatrixReference:M
 MatrixValue:Z
 FunctionInv
 AssignmentOperator:=
245 MAT A = ZER(1,N)
 MatrixReference:A
 NumericConstant:1
 ScalarValue:N
 FunctionZer
 AssignmentOperator:=
250 FOR J = 1 TO N
 control: VariableName:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
260 LET A(1,J) = M(N,J)
 NumericConstant:1
 ScalarValue:J
 ScalarReference:A
 ScalarValue:N
 ScalarValue:J
 ScalarValue:M
 AssignmentOperator:=
270 NEXT J
 VariableName:J
280 PRINT "LIMITING PROBABILITIES"
 ITEMS
 TextConstant:"LIMITING PROBABILITIES"
 CarriageControl:NL
290 PRINT
 ITEMS
 CarriageControl:NL
300 MAT PRINT A;
 ITEMS
 MatrixValue:A
 CarriageControl:;
310
320 MAT M = IDN(N,N)
 MatrixReference:M
 ScalarValue:N
 ScalarValue:N
 FunctionIdn
 AssignmentOperator:=
330 MAT M = M-P
 MatrixReference:M
 MatrixValue:M
 MatrixValue:P
 BinaryOperator:-
 AssignmentOperator:=
340 FOR I = 1 TO N
 control: VariableName:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
350 FOR J = 1 TO N
 control: VariableName:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
360 LET M(I,J) = M(I,J)+A(1,J)
 ScalarValue:I
 ScalarValue:J
 ScalarReference:M
 ScalarValue:I
 ScalarValue:J
 ScalarValue:M
 NumericConstant:1
 ScalarValue:J
 ScalarValue:A
 BinaryOperator:+
 AssignmentOperator:=
370 NEXT J
 VariableName:J
380 NEXT I
 VariableName:I
390 MAT Z = INV(M)
 MatrixReference:Z
 MatrixValue:M
 FunctionInv
 AssignmentOperator:=
400
410 FOR I = 1 TO N
 control: VariableName:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
420 FOR J = 1 TO N
 control: VariableName:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N"]
430 LET M(I,J) = (Z(J,J)-Z(I,J))/A(1,J)
 ScalarValue:I
 ScalarValue:J
 ScalarReference:M
 ScalarValue:J
 ScalarValue:J
 ScalarValue:Z
 ScalarValue:I
 ScalarValue:J
 ScalarValue:Z
 BinaryOperator:-
 NumericConstant:1
 ScalarValue:J
 ScalarValue:A
 BinaryOperator:/
 AssignmentOperator:=
440 NEXT J
 VariableName:J
450 NEXT I
 VariableName:I
460 PRINT "MEAN PASSAGE TIMES"
 ITEMS
 TextConstant:"MEAN PASSAGE TIMES"
 CarriageControl:NL
470 PRINT
 ITEMS
 CarriageControl:NL
480 MAT PRINT M;
 ITEMS
 MatrixValue:M
 CarriageControl:;
490
500 MAT B = A*M
 MatrixReference:B
 MatrixValue:A
 MatrixValue:M
 BinaryOperator:*
 AssignmentOperator:=
510 PRINT "FIRST PASSAGE TIME IN EQUILIBRIUM"
 ITEMS
 TextConstant:"FIRST PASSAGE TIME IN EQUILIBRIUM"
 CarriageControl:NL
520 PRINT
 ITEMS
 CarriageControl:NL
530 MAT PRINT B;
 ITEMS
 MatrixValue:B
 CarriageControl:;
540
550 DATA 3
 NumericConstant:3
560 DATA 0.5, 0.25, 0.25
 NumericConstant:0.5
 NumericConstant:0.25
 NumericConstant:0.25
570 DATA 0.5, 0, 0.5
 NumericConstant:0.5
 NumericConstant:0
 NumericConstant:0.5
580 DATA 0.25, 0.25, 0.5
 NumericConstant:0.25
 NumericConstant:0.25
 NumericConstant:0.5
999 END
 

100: DIM P(20, 20), M(20, 20), Z(20, 20), A(1, 20), B(1, 20)
110:
120: READ N
 N = 3
130: MAT READ P(N, N)
 P(1,1) = 0.5
 P(1,2) = 0.25
 P(1,3) = 0.25
 P(2,1) = 0.5
 P(2,2) = 0
 P(2,3) = 0.5
 P(3,1) = 0.25
 P(3,2) = 0.25
 P(3,3) = 0.5
140: MAT Z = IDN(N, N)
 N: 3
 Z(1,1) = 1
 Z(1,2) = 0
 Z(1,3) = 0
 Z(2,1) = 0
 Z(2,2) = 1
 Z(2,3) = 0
 Z(3,1) = 0
 Z(3,2) = 0
 Z(3,3) = 1
150:
160: PRINT "TRANSITION PROBABILITIES"
TRANSITION PROBABILITIES
170: PRINT

180: MAT PRINT P;
 P(1,1): 0.5
 P(1,2): 0.25
 P(1,3): 0.25
 P(2,1): 0.5
 P(2,2): 0
 P(2,3): 0.5
 P(3,1): 0.25
 P(3,2): 0.25
 P(3,3): 0.5
 0.5      0.25     0.25    
 0.5      0     0.5     
 0.25     0.25     0.5     

190:
200: MAT Z = Z - P
 Z(1,1): 1
 Z(1,2): 0
 Z(1,3): 0
 Z(2,1): 0
 Z(2,2): 1
 Z(2,3): 0
 Z(3,1): 0
 Z(3,2): 0
 Z(3,3): 1
 P(1,1): 0.5
 P(1,2): 0.25
 P(1,3): 0.25
 P(2,1): 0.5
 P(2,2): 0
 P(2,3): 0.5
 P(3,1): 0.25
 P(3,2): 0.25
 P(3,3): 0.5
 Z(1,1) = 0.5
 Z(1,2) = -0.25
 Z(1,3) = -0.25
 Z(2,1) = -0.5
 Z(2,2) = 1
 Z(2,3) = -0.5
 Z(3,1) = -0.25
 Z(3,2) = -0.25
 Z(3,3) = 0.5
210: FOR I = 1 TO N
 N: 3
 I = 1
 N = 3
 terminated:false
220: LET Z(I, N) = 1
 Z(1,3) = 1
230: NEXT I
 I: 1
 terminated:false
 I = 2
220: LET Z(I, N) = 1
 Z(2,3) = 1
230: NEXT I
 I: 2
 terminated:false
 I = 3
220: LET Z(I, N) = 1
 Z(3,3) = 1
230: NEXT I
 I: 3
 terminated:true
240: MAT M = INV(Z)
 Z(1,1): 0.5
 Z(1,2): -0.25
 Z(1,3): 1
 Z(2,1): -0.5
 Z(2,2): 1
 Z(2,3): 1
 Z(3,1): -0.25
 Z(3,2): -0.25
 Z(3,3): 1
 M(1,1) = 1.3333333333333333
 M(1,2) = -5.551115123125783e-17
 M(1,3) = -1.3333333333333335
 M(2,1) = 0.2666666666666666
 M(2,2) = 0.7999999999999999
 M(2,3) = -1.0666666666666667
 M(3,1) = 0.4
 M(3,2) = 0.2
 M(3,3) = 0.4
245: MAT A = ZER(1, N)
 N: 3
 A(1,1) = 0
 A(1,2) = 0
 A(1,3) = 0
250: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
260: LET A(1, J) = M(N, J)
 N: 3
 J: 1
 M(3,1): 0.4
 A(1,1) = 0.4
270: NEXT J
 J: 1
 terminated:false
 J = 2
260: LET A(1, J) = M(N, J)
 N: 3
 J: 2
 M(3,2): 0.2
 A(1,2) = 0.2
270: NEXT J
 J: 2
 terminated:false
 J = 3
260: LET A(1, J) = M(N, J)
 N: 3
 J: 3
 M(3,3): 0.4
 A(1,3) = 0.4
270: NEXT J
 J: 3
 terminated:true
280: PRINT "LIMITING PROBABILITIES"
LIMITING PROBABILITIES
290: PRINT

300: MAT PRINT A;
 A(1,1): 0.4
 A(1,2): 0.2
 A(1,3): 0.4
 0.4      0.2      0.4     

310:
320: MAT M = IDN(N, N)
 N: 3
 M(1,1) = 1
 M(1,2) = 0
 M(1,3) = 0
 M(2,1) = 0
 M(2,2) = 1
 M(2,3) = 0
 M(3,1) = 0
 M(3,2) = 0
 M(3,3) = 1
330: MAT M = M - P
 M(1,1): 1
 M(1,2): 0
 M(1,3): 0
 M(2,1): 0
 M(2,2): 1
 M(2,3): 0
 M(3,1): 0
 M(3,2): 0
 M(3,3): 1
 P(1,1): 0.5
 P(1,2): 0.25
 P(1,3): 0.25
 P(2,1): 0.5
 P(2,2): 0
 P(2,3): 0.5
 P(3,1): 0.25
 P(3,2): 0.25
 P(3,3): 0.5
 M(1,1) = 0.5
 M(1,2) = -0.25
 M(1,3) = -0.25
 M(2,1) = -0.5
 M(2,2) = 1
 M(2,3) = -0.5
 M(3,1) = -0.25
 M(3,2) = -0.25
 M(3,3) = 0.5
340: FOR I = 1 TO N
 N: 3
 I = 1
 N = 3
 terminated:false
350: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 1
 J: 1
 M(1,1): 0.5
 A(1,1): 0.4
 M(1,1) = 0.9
370: NEXT J
 J: 1
 terminated:false
 J = 2
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 1
 J: 2
 M(1,2): -0.25
 A(1,2): 0.2
 M(1,2) = -0.04999999999999999
370: NEXT J
 J: 2
 terminated:false
 J = 3
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 1
 J: 3
 M(1,3): -0.25
 A(1,3): 0.4
 M(1,3) = 0.15000000000000002
370: NEXT J
 J: 3
 terminated:true
380: NEXT I
 I: 1
 terminated:false
 I = 2
350: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 2
 J: 1
 M(2,1): -0.5
 A(1,1): 0.4
 M(2,1) = -0.09999999999999998
370: NEXT J
 J: 1
 terminated:false
 J = 2
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 2
 J: 2
 M(2,2): 1
 A(1,2): 0.2
 M(2,2) = 1.2
370: NEXT J
 J: 2
 terminated:false
 J = 3
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 2
 J: 3
 M(2,3): -0.5
 A(1,3): 0.4
 M(2,3) = -0.09999999999999998
370: NEXT J
 J: 3
 terminated:true
380: NEXT I
 I: 2
 terminated:false
 I = 3
350: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 3
 J: 1
 M(3,1): -0.25
 A(1,1): 0.4
 M(3,1) = 0.15000000000000002
370: NEXT J
 J: 1
 terminated:false
 J = 2
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 3
 J: 2
 M(3,2): -0.25
 A(1,2): 0.2
 M(3,2) = -0.04999999999999999
370: NEXT J
 J: 2
 terminated:false
 J = 3
360: LET M(I, J) = M(I, J) + A(1, J)
 I: 3
 J: 3
 M(3,3): 0.5
 A(1,3): 0.4
 M(3,3) = 0.9
370: NEXT J
 J: 3
 terminated:true
380: NEXT I
 I: 3
 terminated:true
390: MAT Z = INV(M)
 M(1,1): 0.9
 M(1,2): -0.04999999999999999
 M(1,3): 0.15000000000000002
 M(2,1): -0.09999999999999998
 M(2,2): 1.2
 M(2,3): -0.09999999999999998
 M(3,1): 0.15000000000000002
 M(3,2): -0.04999999999999999
 M(3,3): 0.9
 Z(1,1) = 1.1466666666666667
 Z(1,2) = 0.039999999999999994
 Z(1,3) = -0.18666666666666668
 Z(2,1) = 0.07999999999999997
 Z(2,2) = 0.8400000000000001
 Z(2,3) = 0.07999999999999999
 Z(3,1) = -0.18666666666666668
 Z(3,2) = 0.039999999999999994
 Z(3,3) = 1.1466666666666667
400:
410: FOR I = 1 TO N
 N: 3
 I = 1
 N = 3
 terminated:false
420: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 1
 Z(1,1): 1.1466666666666667
 I: 1
 Z(1,1): 1.1466666666666667
 A(1,1): 0.4
 M(1,1) = 0
440: NEXT J
 J: 1
 terminated:false
 J = 2
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 2
 Z(2,2): 0.8400000000000001
 I: 1
 Z(1,2): 0.039999999999999994
 A(1,2): 0.2
 M(1,2) = 4
440: NEXT J
 J: 2
 terminated:false
 J = 3
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 3
 Z(3,3): 1.1466666666666667
 I: 1
 Z(1,3): -0.18666666666666668
 A(1,3): 0.4
 M(1,3) = 3.3333333333333335
440: NEXT J
 J: 3
 terminated:true
450: NEXT I
 I: 1
 terminated:false
 I = 2
420: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 1
 Z(1,1): 1.1466666666666667
 I: 2
 Z(2,1): 0.07999999999999997
 A(1,1): 0.4
 M(2,1) = 2.6666666666666665
440: NEXT J
 J: 1
 terminated:false
 J = 2
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 2
 Z(2,2): 0.8400000000000001
 I: 2
 Z(2,2): 0.8400000000000001
 A(1,2): 0.2
 M(2,2) = 0
440: NEXT J
 J: 2
 terminated:false
 J = 3
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 3
 Z(3,3): 1.1466666666666667
 I: 2
 Z(2,3): 0.07999999999999999
 A(1,3): 0.4
 M(2,3) = 2.6666666666666665
440: NEXT J
 J: 3
 terminated:true
450: NEXT I
 I: 2
 terminated:false
 I = 3
420: FOR J = 1 TO N
 N: 3
 J = 1
 N = 3
 terminated:false
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 1
 Z(1,1): 1.1466666666666667
 I: 3
 Z(3,1): -0.18666666666666668
 A(1,1): 0.4
 M(3,1) = 3.3333333333333335
440: NEXT J
 J: 1
 terminated:false
 J = 2
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 2
 Z(2,2): 0.8400000000000001
 I: 3
 Z(3,2): 0.039999999999999994
 A(1,2): 0.2
 M(3,2) = 4
440: NEXT J
 J: 2
 terminated:false
 J = 3
430: LET M(I, J) = (Z(J, J) - Z(I, J)) / A(1, J)
 J: 3
 Z(3,3): 1.1466666666666667
 I: 3
 Z(3,3): 1.1466666666666667
 A(1,3): 0.4
 M(3,3) = 0
440: NEXT J
 J: 3
 terminated:true
450: NEXT I
 I: 3
 terminated:true
460: PRINT "MEAN PASSAGE TIMES"
MEAN PASSAGE TIMES
470: PRINT

480: MAT PRINT M;
 M(1,1): 0
 M(1,2): 4
 M(1,3): 3.3333333333333335
 M(2,1): 2.6666666666666665
 M(2,2): 0
 M(2,3): 2.6666666666666665
 M(3,1): 3.3333333333333335
 M(3,2): 4
 M(3,3): 0
 0     4     3.33333    
 2.66667     0     2.66667    
 3.33333     4     0    

490:
500: MAT B = A * M
 A(1,1): 0.4
 A(1,2): 0.2
 A(1,3): 0.4
 M(1,1): 0
 M(1,2): 4
 M(1,3): 3.3333333333333335
 M(2,1): 2.6666666666666665
 M(2,2): 0
 M(2,3): 2.6666666666666665
 M(3,1): 3.3333333333333335
 M(3,2): 4
 M(3,3): 0
 B(1,1) = 1.8666666666666667
 B(1,2) = 3.2
 B(1,3) = 1.8666666666666667
510: PRINT "FIRST PASSAGE TIME IN EQUILIBRIUM"
FIRST PASSAGE TIME IN EQUILIBRIUM
520: PRINT

530: MAT PRINT B;
 B(1,1): 1.8666666666666667
 B(1,2): 3.2
 B(1,3): 1.8666666666666667
 1.86667     3.2      1.86667    

540:
550: DATA 3
560: DATA 0.5, 0.25, 0.25
570: DATA 0.5, 0, 0.5
580: DATA 0.25, 0.25, 0.5
999: END
STOP in line 999

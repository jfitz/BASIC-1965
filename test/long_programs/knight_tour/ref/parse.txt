100 OPTION BASE 0
 NumericConstant:0
110 REM squares visited
 Remark:squares visited
112 DIM V(64)
 NumericConstant:64
 Declaration:V
114 MAT LET V = ZER(64)
 Variable:V
 NumericConstant:64
 FunctionZer
 AssignmentOperator:=
120 REM square at each level
 Remark:square at each level
122 DIM S(64)
 NumericConstant:64
 Declaration:S
130 REM possible moves for each level
 Remark:possible moves for each level
132 DIM P(64,8)
 NumericConstant:64
 NumericConstant:8
 Declaration:P
200 REM Calculate row from square
 Remark:Calculate row from square
202 DEF FNR(S)=INT(S / 8) + 1
 UserFunctionName:FNR
 VariableName:S
 Variable:S
 NumericConstant:8
 BinaryOperator:/
 FunctionInt
 NumericConstant:1
 BinaryOperator:+
210 REM Calculate column from square
 Remark:Calculate column from square
212 DEF FNC(S)=MOD(S, 8) + 1
 UserFunctionName:FNC
 VariableName:S
 Variable:S
 NumericConstant:8
 FunctionMod
 NumericConstant:1
 BinaryOperator:+
220 REM Calculate square from row and column
 Remark:Calculate square from row and column
222 DEF FNS(R,C)=(R - 1) * 8 + (C - 1)
 UserFunctionName:FNS
 VariableName:R
 VariableName:C
 Variable:R
 NumericConstant:1
 BinaryOperator:-
 NumericConstant:8
 BinaryOperator:*
 Variable:C
 NumericConstant:1
 BinaryOperator:-
 BinaryOperator:+
400 REM current level
 Remark:current level
402 LET L = 0
 Variable:L
 NumericConstant:0
 AssignmentOperator:=
410 REM go to a square (a1, or 1,1, or 1)
 Remark:go to a square (a1, or 1,1, or 1)
412 LET S = 0
 Variable:S
 NumericConstant:0
 AssignmentOperator:=
500 REM MAIN LOOP
 Remark:MAIN LOOP
510 REM ENTER NEXT LEVEL
 Remark:ENTER NEXT LEVEL
512 LET L = L + 1
 Variable:L
 Variable:L
 NumericConstant:1
 BinaryOperator:+
 AssignmentOperator:=
513 REM PRINT "GOING TO LEVEL";L;" SQUARE";S;" (";FNR(S);",";FNC(S);")"
 Remark:PRINT "GOING TO LEVEL";L;" SQUARE";S;" (";FNR(S);",";FNC(S);")"
514 LET S(L) = S
 Variable:L
 Variable:S
 Variable:S
 AssignmentOperator:=
515 LET V(S) = 1
 Variable:S
 Variable:V
 NumericConstant:1
 AssignmentOperator:=
516 REM if level 64, we are done
 Remark:if level 64, we are done
518 IF L = 64 THEN 800
 Variable:L
 NumericConstant:64
 BinaryOperator:=
520 REM COMPUTE POSSIBLE MOVES
 Remark:COMPUTE POSSIBLE MOVES
522 GOSUB 600
 LineNumber:600
530 REM while possible move
 Remark:while possible move
531 REM GOSUB 1520
 Remark:GOSUB 1520
532 LET S2 = -1
 Variable:S2
 NumericConstant:1
 UnaryOperator:-
 AssignmentOperator:=
534 FOR I = 8 TO 1 STEP -1
 control: Variable:I
 start:   ["NumericConstant:8"]
 end:     ["NumericConstant:1"]
 step:    ["NumericConstant:1", "UnaryOperator:-"]
536 IF P(L,I) = -1 THEN 538
 Variable:L
 Variable:I
 Variable:P
 NumericConstant:1
 UnaryOperator:-
 BinaryOperator:=
537 LET S2 = P(L,I)
 Variable:S2
 Variable:L
 Variable:I
 Variable:P
 AssignmentOperator:=
538 NEXT I
 Variable:I
542 IF S2 = -1 THEN 550
 Variable:S2
 NumericConstant:1
 UnaryOperator:-
 BinaryOperator:=
544 REM GO TO SQUARE S2
 Remark:GO TO SQUARE S2
546 LET S = S2
 Variable:S
 Variable:S2
 AssignmentOperator:=
548 GOTO 510
 LineNumber:510
550 REM MARK SQUARE AS NOT VISITED
 Remark:MARK SQUARE AS NOT VISITED
552 LET V(S) = 0
 Variable:S
 Variable:V
 NumericConstant:0
 AssignmentOperator:=
560 REM revert to previous level
 Remark:revert to previous level
562 LET L = L - 1
 Variable:L
 Variable:L
 NumericConstant:1
 BinaryOperator:-
 AssignmentOperator:=
564 IF L = 0 THEN 820
 Variable:L
 NumericConstant:0
 BinaryOperator:=
570 REM mark first possible square as not possible
 Remark:mark first possible square as not possible
572 FOR I = 1 TO 8
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["NumericConstant:8"]
574 IF P(L,I) <> S THEN 577 
 Variable:L
 Variable:I
 Variable:P
 Variable:S
 BinaryOperator:<>
575 LET P(L,I) = -1
 Variable:L
 Variable:I
 Variable:P
 NumericConstant:1
 UnaryOperator:-
 AssignmentOperator:=
577 NEXT I
 Variable:I
580 REM RETURN TO PREVIOUS SQUARE
 Remark:RETURN TO PREVIOUS SQUARE
582 LET S = S(L)
 Variable:S
 Variable:L
 Variable:S
 AssignmentOperator:=
584 REM PRINT "REVERTING TO LEVEL";L;" SQUARE";S
 Remark:PRINT "REVERTING TO LEVEL";L;" SQUARE";S
590 GOTO 530
 LineNumber:530
600 REM build possible moves
 Remark:build possible moves
602 LET R = FNR(S)
 Variable:R
 Variable:S
 UserFunction
 AssignmentOperator:=
604 LET C = FNC(S)
 Variable:C
 Variable:S
 UserFunction
 AssignmentOperator:=
610 REM up up left
 Remark:up up left
611 LET P = 1
 Variable:P
 NumericConstant:1
 AssignmentOperator:=
612 LET R5 = R - 2
 Variable:R5
 Variable:R
 NumericConstant:2
 BinaryOperator:-
 AssignmentOperator:=
613 LET C5 = C - 1
 Variable:C5
 Variable:C
 NumericConstant:1
 BinaryOperator:-
 AssignmentOperator:=
615 GOSUB 700
 LineNumber:700
620 REM up up right
 Remark:up up right
621 LET P = 2
 Variable:P
 NumericConstant:2
 AssignmentOperator:=
622 LET R5 = R - 2
 Variable:R5
 Variable:R
 NumericConstant:2
 BinaryOperator:-
 AssignmentOperator:=
623 LET C5 = C + 1
 Variable:C5
 Variable:C
 NumericConstant:1
 BinaryOperator:+
 AssignmentOperator:=
625 GOSUB 700
 LineNumber:700
630 REM down down left
 Remark:down down left
631 LET P = 3
 Variable:P
 NumericConstant:3
 AssignmentOperator:=
632 LET R5 = R + 2
 Variable:R5
 Variable:R
 NumericConstant:2
 BinaryOperator:+
 AssignmentOperator:=
633 LET C5 = C - 1
 Variable:C5
 Variable:C
 NumericConstant:1
 BinaryOperator:-
 AssignmentOperator:=
635 GOSUB 700
 LineNumber:700
640 REM down down right
 Remark:down down right
641 LET P = 4
 Variable:P
 NumericConstant:4
 AssignmentOperator:=
642 LET R5 = R + 2
 Variable:R5
 Variable:R
 NumericConstant:2
 BinaryOperator:+
 AssignmentOperator:=
643 LET C5 = C + 1
 Variable:C5
 Variable:C
 NumericConstant:1
 BinaryOperator:+
 AssignmentOperator:=
645 GOSUB 700
 LineNumber:700
650 REM left left up
 Remark:left left up
651 LET P = 5
 Variable:P
 NumericConstant:5
 AssignmentOperator:=
652 LET R5 = R - 1
 Variable:R5
 Variable:R
 NumericConstant:1
 BinaryOperator:-
 AssignmentOperator:=
653 LET C5 = C - 2
 Variable:C5
 Variable:C
 NumericConstant:2
 BinaryOperator:-
 AssignmentOperator:=
655 GOSUB 700
 LineNumber:700
660 REM left left down
 Remark:left left down
661 LET P = 6
 Variable:P
 NumericConstant:6
 AssignmentOperator:=
662 LET R5 = R + 1
 Variable:R5
 Variable:R
 NumericConstant:1
 BinaryOperator:+
 AssignmentOperator:=
663 LET C5 = C - 2
 Variable:C5
 Variable:C
 NumericConstant:2
 BinaryOperator:-
 AssignmentOperator:=
665 GOSUB 700
 LineNumber:700
670 REM right right up
 Remark:right right up
671 LET P = 7
 Variable:P
 NumericConstant:7
 AssignmentOperator:=
672 LET R5 = R - 1
 Variable:R5
 Variable:R
 NumericConstant:1
 BinaryOperator:-
 AssignmentOperator:=
673 LET C5 = C + 2
 Variable:C5
 Variable:C
 NumericConstant:2
 BinaryOperator:+
 AssignmentOperator:=
675 GOSUB 700
 LineNumber:700
680 REM right right down
 Remark:right right down
681 LET P = 8
 Variable:P
 NumericConstant:8
 AssignmentOperator:=
682 LET R5 = R + 1
 Variable:R5
 Variable:R
 NumericConstant:1
 BinaryOperator:+
 AssignmentOperator:=
683 LET C5 = C + 2
 Variable:C5
 Variable:C
 NumericConstant:2
 BinaryOperator:+
 AssignmentOperator:=
685 GOSUB 700
 LineNumber:700
690 RETURN
 
700 REM VALIDATE POSSIBLE MOVE
 Remark:VALIDATE POSSIBLE MOVE
701 REM moves off the board are illegal
 Remark:moves off the board are illegal
710 IF R5 < 1 THEN 770
 Variable:R5
 NumericConstant:1
 BinaryOperator:<
715 IF R5 > 8 THEN 770
 Variable:R5
 NumericConstant:8
 BinaryOperator:>
720 IF C5 < 1 THEN 770
 Variable:C5
 NumericConstant:1
 BinaryOperator:<
725 IF C5 > 8 THEN 770
 Variable:C5
 NumericConstant:8
 BinaryOperator:>
730 REM moves to squares already visited are illegal
 Remark:moves to squares already visited are illegal
732 LET S5 = FNS(R5, C5)
 Variable:S5
 Variable:R5
 Variable:C5
 UserFunction
 AssignmentOperator:=
734 IF V(S5) > 0 THEN 770
 Variable:S5
 Variable:V
 NumericConstant:0
 BinaryOperator:>
750 REM THE MOVE IS LEGAL
 Remark:THE MOVE IS LEGAL
752 LET P(L,P) = S5
 Variable:L
 Variable:P
 Variable:P
 Variable:S5
 AssignmentOperator:=
755 GOTO 790
 LineNumber:790
770 REM THE MOVE IS NOT LEGAL
 Remark:THE MOVE IS NOT LEGAL
772 LET P(L,P) = -1
 Variable:L
 Variable:P
 Variable:P
 NumericConstant:1
 UnaryOperator:-
 AssignmentOperator:=
790 RETURN
 
800 PRINT "SUCCESS!"
 TextConstant:"SUCCESS!"
 CarriageControl:NL
810 GOTO 900
 LineNumber:900
820 PRINT "INCOMPLETE"
 TextConstant:"INCOMPLETE"
 CarriageControl:NL
900 PRINT "THE TOUR IS:"
 TextConstant:"THE TOUR IS:"
 CarriageControl:NL
910 FOR I = 1 TO 64
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["NumericConstant:64"]
920 LET R = FNR(S(I))
 Variable:R
 Variable:I
 Variable:S
 UserFunction
 AssignmentOperator:=
922 LET C = FNC(S(I))
 Variable:C
 Variable:I
 Variable:S
 UserFunction
 AssignmentOperator:=
930 PRINT R;C
 Variable:R
 CarriageControl:;
 Variable:C
 CarriageControl:NL
940 PRINT "TOUR ENDS"
 TextConstant:"TOUR ENDS"
 CarriageControl:NL
950 STOP
 
1520 REM PRINT POSSIBLE MOVES
 Remark:PRINT POSSIBLE MOVES
1523 PRINT "POSSIBLE MOVES:";
 TextConstant:"POSSIBLE MOVES:"
 CarriageControl:;
1524 FOR I = 1 TO 8
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["NumericConstant:8"]
1525 PRINT P(L,I);
 Variable:L
 Variable:I
 Variable:P
 CarriageControl:;
1526 NEXT I
 Variable:I
1527 PRINT
 CarriageControl:NL
1529 RETURN
 
1999 END
 

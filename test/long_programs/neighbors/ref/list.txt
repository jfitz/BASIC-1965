10 REM SIMULATION OF NEIGHBORS AND MOVES
20 OPTION BASE 0
100 REM collect data
110 READ R0,C0
120 READ N0
122 DIM M(N0)
130 READ D0
132 READ I0
134 READ Z8
136 LET Z0 = R0 * 2 + C0 * 2 + Z8
150 PRINT "Board size:";R0+1;"x";C0+1
152 PRINT "Number of populations:";N0
154 PRINT "Discomfort threshold:";D0
156 PRINT "Iteration threshold:";I0
158 PRINT "Number of zero cells:";Z0
200 REM configure initial board
210 PRINT "Initializing board... ";
220 GOSUB 1100
230 PRINT "done."
240 LET I1 = 1
242 LET P2 = 0.99
300 REM display board
310 PRINT
312 PRINT "Iteration";I1;":"
314 PRINT
320 GOSUB 1200
400 REM ask to continue
410 IF P2 < I0 THEN 900
430 LET I1 = I1 + 1
500 REM calculate comfort
510 PRINT "Calculating moves... ";
520 GOSUB 1300
530 PRINT "done."
540 PRINT "Moves: ";
542 ARR PRINT M;
550 LET M = 0
552 FOR I = 1 TO N0
554 LET M = M + M(I)
556 NEXT I
558 LET T = (R0+1) * (C0+1) - Z0
560 LET P2 = M / T
562 PRINT "(";P2*100;"%)"
570 PRINT
600 REM fill in new board
610 PRINT "Filling in new board... ";
620 GOSUB 1400
630 PRINT "done."
700 REM new board becomes the board
710 MAT B = B1
800 GOTO 300
900 REM End the simulation
910 PRINT
920 PRINT "SIMULATION TERMINATED"
990 STOP
1100 REM configure initial board
1110 REM SET EVERYTHING TO -1
1112 MAT B = CON(R0,C0) * -1
1120 REM SET HORIZONTAL BORDERS TO 0
1122 FOR C = 0 TO C0
1124 LET B(0,C) = 0
1126 LET B(R0,C) = 0
1128 NEXT C
1130 REM SET VERTICAL BORDERS TO 0
1132 FOR R = 0 TO R0
1134 LET B(R,0) = 0
1136 LET B(R,C0) = 0
1138 NEXT R
1140 REM SET INSIDE EMPTY AREAS TO 0
1142 FOR I = 1 TO Z8
1144 READ R,C
1146 LET B(R,C) = 0
1148 NEXT I
1150 REM SET REMAINING CELLS TO POPULATION GROUP
1152 FOR R = 1 TO R0-1
1153 FOR C = 1 TO C0-1
1154 IF B(R,C) <> -1 THEN 1157
1155 LET B(R,C)=INT(RND(N0)+1)
1157 NEXT C
1158 NEXT R
1190 RETURN
1200 REM display board
1210 MAT PRINT B;
1290 RETURN
1300 REM calculate comfort, count people who move
1302 MAT B1 = B
1304 MAT M = ZER()
1310 FOR R = 1 TO R0-1
1312 FOR C = 1 TO C0-1
1314 IF B(R,C) = 0 THEN 1380
1317 LET X7 = 0
1318 LET X8 = 0
1320 FOR I9 = -1 TO 1
1322 FOR J9 = -1 TO 1
1330 IF B(R+I9,C+J9) = 0 THEN 1340
1332 IF B(R+I9,C+J9) = B(R,C) THEN 1340
1334 LET X8 = X8 + 1
1336 GOTO 1350
1340 LET X7 = X7 + 1
1350 NEXT J9
1352 NEXT I9
1360 LET X = X8 / X7
1370 IF X < D0 THEN 1380
1372 LET M(B(R,C)) = M(B(R,C)) + 1
1374 LET B1(R,C) = -1
1380 NEXT C
1382 NEXT R
1390 RETURN
1400 REM fill in new board
1410 FOR R = 1 TO R0-1
1412 FOR C = 1 TO C0-1
1420 IF B1(R,C) <> -1 THEN 1450
1430 LET P = INT(RND(N0)+1)
1432 IF M(P) <= 0 THEN 1430
1440 LET B1(R,C) = P
1442 LET M(P) = M(P) - 1
1450 NEXT C
1452 NEXT R
1490 RETURN
3000 REM NUMBER OF ROWS AND COLUMNS
3005 DATA 40,40
3010 REM NUMBER OF POPULATION GROUPS
3012 DATA 3
3020 REM DISCOMFORT THRESHOLD, ITERATION THRESHOLD
3022 DATA 0.8, 0.10
3030 REM NUMBER OF ZERO-CELLS
3032 DATA 73
3050 REM COORDS FOR ZERO-CELLS
3051 DATA 1,10,2,10,3,10,4,10,5,10
3052 DATA 39,20,38,20,37,20,36,20,35,20,34,20,33,20,32,20,31,20,30,20
3053 DATA 29,20,28,20,27,20,26,20,25,20
3054 DATA 6,11,7,12,8,13,9,14,10,15,11,16,12,17,13,18
3055 DATA 12,1,12,2,12,3,12,4,12,5,12,6
3056 DATA 18,39,18,38,18,37,18,36,18,35,18,34
3057 DATA 24,19,23,18,22,17,21,16,20,15,19,14,18,13,17,12,16,11
3058 DATA 24,21,23,22,22,23,21,24,20,25,19,26,18,27,17,28,16,29,16,30,16,31,16,32,17,33
3059 DATA 24,20,23,20,22,20,21,20,20,20,19,20,18,20,17,20,16,20,15,20,14,19,13,19
4999 END
